# Frist Chapter Labs Solutions

## Lab 1-1:
**Using Sample: Lab01-01.exe & Lab01-01.dll**

### Questions:
Q1- Upload the files to http://www.VirusTotal.com/ and view the reports. Does
either file match any existing antivirus signatures?

A1- VirusTotal Results:
![](/pics/VirusTotal.png)
<br>
Q2- When were these files compiled?

A2- We can determine this time by looking at time stamp field in **PEview** in IMAGE_NT_HEADERS and IMAGE_FILE_HEADER.
![](/pics/Time_Stamp.png)
<br>
Q3- Are there any indications that either of these files is packed or obfuscated?
If so, what are these indicators?

A3- There is no indicator that this file is packed.
<br>
 Q4- Do any imports hint at what this malware does? If so, which imports
are they?

A4- There are some interseting imports we find in **exe** 
![](/pics/interested_imports.png) <br>
From these imports we can conclude that this **exe** search for files and copy ones. 
<br>

Q5- Are there any other files or host-based indicators that you could look for
on infected systems?

A5- If we extracted strings from this file we will find some of important strings.
![](/pics/Host_based_indicator.png) <br>
We will find this path which contain kernel32.dll, but if we look at this name well we will figure out **l** in this file is in fact **1**, so we can conclude that this file is not original dll, so we may get a host base indicator for this file.<br>
<br>
Q6- What network-based indicators could be used to find this malware on
infected machines?

A6- If we extrac strings from **dll** file we will find an IP address, So we can take this ip as network indicator.

![](/pics/Network_Indicator.png) 
<br>
Q7- What would you guess is the purpose of these files?

A7- I think it's like a backdoor
<br>
<hr />

## Lab 1-2
**Using Sample: Lab01-02.exe**

### Questions:

Q1- Upload the Lab01-02.exe file to http://www.VirusTotal.com/. Does it match
any existing antivirus definitions?


A1- Yes it match.
![](/pics/L2_virusTotal.png)
<br>

Q2- Are there any indications that this file is packed or obfuscated? If so,
what are these indicators? If the file is packed, unpack it if possible.

A2- Yes this file is packed beacuse if we look at **IMPORT_ADDRESS_TABLE** we will find few imports and we also will see **LoadLibraryA** and **GetProcAddress** 
![](/pics/L2_packed.png)
<br>

Q3- Do any imports hint at this program’s functionality? If so, which imports
are they and what do they tell you?

A3- Yes, there is import called **InternetOpenA** which try to connect with url.
<br>

Q4- What host- or network-based indicators could be used to identify this
malware on infected machines?

A4- There is a url we will find it if we extract strings 
![](/pics/L2_URL.png)

## Lab 1-3
**Using Sample: Lab01-03.exe**

### Questions:

Q1- Upload the Lab01-03.exe file to http://www.VirusTotal.com/. Does it match
any existing antivirus definitions?

A1- ![](/pics/L3_vt.png)
<br>

Q2- Are there any indications that this file is packed or obfuscated? If so,
what are these indicators? If the file is packed, unpack it if possible.

A2- There are two indicators that this file is packed.
First one if we look at imports we will find only **LoadLibraryA** and **GetProcAddress**, which good indicator for packing.
![](/pics/L3_few_import.png) <br>
Second one if we compare Virtual size and size of raw data we will find that virtual size is too big comparing with size of raw data, which also good indicator for packing.
![](/pics/L3_vs_srd_notmatch.png) <br>

Q3- Do any imports hint at this program’s functionality? If so, which imports
are they and what do they tell you?

A3- For answer this question we need first unpack this sample, so we will skip it right now.
<br>

Q4- What host- or network-based indicators could be used to identify this
malware on infected machines?

A4- As mentioned above.
<br>
<hr />

## Lab 1-4
**Using Sample: Lab01-04.exe**

### Questions:

Q1- Upload the Lab01-04.exe file to http://www.VirusTotal.com/. Does it match
any existing antivirus definitions?

A1- ![](/pics/L4_vs.png) <br>

Q2- Are there any indications that this file is packed or obfuscated? If so,
what are these indicators? If the file is packed, unpack it if possible.

A2- No this file unpacked.
<br>
Q3- When was this program compiled?
<br>
A3- ![](/pics/L4_comiletime.png)
<br>

Q4- Do any imports hint at this program’s functionality? If so, which imports
are they and what do they tell you?

A4- If we look at import we will find advapi32.dll and some functions which indicates that this malware try to play in permissions and privilege, also **WriteFile** and **WinExec** which indicate that this malware try to write something to file and also execute one.
![](/pics/L4_imports.png)
<br>

Q5- What host- or network-based indicators could be used to identify this
malware on infected machines?

A5- ![](/pics/L4_Host_Network_indicator.png) <br>
If we look at strings extracted from exe we will find that a PATH and URL which a good indicators that this exe try to connect to this url and create this file .

<br>

Q6- This file has one resource in the resource section. Use Resource Hacker
to examine that resource, and then use it to extract the resource. What
can you learn from the resource?

A6- ![](/pics/L4_BIn.png) <br>
So if we look at import we will find **GetWindowsDirectoryA** Which retrieves the path of the Windows directory. if we look at strings again we will find path but not complete, So we can figure out that this BIN will concatenate this piece of path with Windows directory to complete the path and **WinExec** can tell us that after this operation this file will be executed. We also see **URLDownloadToFileA** and also we saw URL in strings so it's a good indicator that this malware is a **Loader** download something from url and execute it after this. <br>

<hr/>